<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URL-Shortner</title>
    <link rel="icon" type="image/x-icon" href= "./images/favicon.ico">
    <!-- <link rel="stylesheet" href="./styles.css"> -->
    <style>
        body{
    background-color: #A0D995;
}

#header{
    font-family: 'Permanent Marker', cursive;
    color: #F6E3C5 ;
    background-color: #4CACBC;
    padding: 1rem;
    border-bottom-left-radius: 0.5rem;
    border-bottom-right-radius: 0.5rem;
}
    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&display=swap" rel="stylesheet">
</head>
<body>
    <div id = "header" class="container-fluid jumbotron">
        <h1>URL SHORTNER</h1>
    </div>
    <input id="auto" name="auto" class="form-control form-control-lg" type="text" placeholder="Enter the URL to shorten" >
    <div id = "short"></div>
    <button type="submit" class="btn btn-primary" id="subbb">Submit</button>
    <script >
        
    async function postData(){
    document.getElementById('short').innerHTML = 'Loading...';

    var dat = {
        longUrl: document.getElementById('auto').value
    //     // longUrl: "https://www.w3schools.com/tags/att_input_value.asp"
        
    }
    // var dat = {"longUrl":"https://codeforces.com/"}
    console.log(dat);
    const response = await fetch('https://l-sh.herokuapp.com/api/url/shorten/',{
        method: 'POST',
        mode: 'cors',
        headers:{
            
            "Content-type": "application/json; charset=UTF-8"
            
            
        },
        AccessControlAllowOrigin: '*',
        ReferrerPolicy: 'no-referrer',
        redirect: 'follow',
        body: JSON.stringify(dat)
        
    });
    return response.json();
    console.log(`data is recieved & data = ${dat.longUrl}`)
    
    if(response.ok) alert (response.json());
}
    function print(){
   console.log("getElementById");
   console.log(document.getElementById("auto").value);
    }
    var output;

    function foo(){
    postData().
    then(data=>{
        // console.log('Sucess: ',data);
        output= data.shortUrl;
        console.log(output);
        if(!output){
            output = 'INVALID LONG URL'
        }
        document.getElementById('short').innerHTML = output;
        // alert(output);

    }).
    catch((err)=> {console.error('Error: ',err);});
    // const p = document.createElement("p");
    // const node = document.createTextNode(output[2];
    // p.appendChild(node);
    // document.getElementById("header").appendChild(p);
}


function f(){

}

// postData();
document.getElementById("subbb").addEventListener('click',foo);
// postData

// );
// );
// }));

// document.getElementById("subbb").addEventListener('click',()=> console.log('hey'));
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
   
</body>
</html>